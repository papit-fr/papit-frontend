<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>google_images_download.google_images_download &#8212; google-images-download 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/papit.png"></span>
          google-images-download</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/phe-sto">GitHub</a></li>
                <li><a href="https://www.papit.fr">PapIT</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Google Images Download <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <h1>Source code for google_images_download.google_images_download</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Searching and Downloading Google Images to the local disk</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">http.client</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">ssl</span>
<span class="c1"># Import Libraries</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span><span class="p">,</span> <span class="n">perf_counter</span>  <span class="c1"># Importing the time library to check the time of code execution</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="k">import</span> <span class="n">quote</span>
<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="k">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">urlopen</span><span class="p">,</span> <span class="n">URLError</span><span class="p">,</span> <span class="n">HTTPError</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="k">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="k">import</span> <span class="n">Keys</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;google-images-download.log&#39;</span><span class="p">,</span>
                    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> -- </span><span class="si">%(name)s</span><span class="s2"> -- </span><span class="si">%(levelname)s</span><span class="s2"> -- </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">_MAXHEADERS</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">ARGS_LIST</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;keywords&quot;</span><span class="p">,</span> <span class="s2">&quot;keywords_from_file&quot;</span><span class="p">,</span> <span class="s2">&quot;prefix_keywords&quot;</span><span class="p">,</span> <span class="s2">&quot;suffix_keywords&quot;</span><span class="p">,</span>
             <span class="s2">&quot;limit&quot;</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="s2">&quot;color_type&quot;</span><span class="p">,</span> <span class="s2">&quot;usage_rights&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span>
             <span class="s2">&quot;exact_size&quot;</span><span class="p">,</span> <span class="s2">&quot;aspect_ratio&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;time_range&quot;</span><span class="p">,</span> <span class="s2">&quot;delay&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;single_image&quot;</span><span class="p">,</span>
             <span class="s2">&quot;output_directory&quot;</span><span class="p">,</span> <span class="s2">&quot;image_directory&quot;</span><span class="p">,</span> <span class="s2">&quot;no_directory&quot;</span><span class="p">,</span> <span class="s2">&quot;proxy&quot;</span><span class="p">,</span> <span class="s2">&quot;similar_images&quot;</span><span class="p">,</span> <span class="s2">&quot;specific_site&quot;</span><span class="p">,</span>
             <span class="s2">&quot;print_urls&quot;</span><span class="p">,</span> <span class="s2">&quot;print_size&quot;</span><span class="p">,</span> <span class="s2">&quot;print_paths&quot;</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="s2">&quot;extract_metadata&quot;</span><span class="p">,</span> <span class="s2">&quot;socket_timeout&quot;</span><span class="p">,</span>
             <span class="s2">&quot;thumbnail&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;prefix&quot;</span><span class="p">,</span> <span class="s2">&quot;chrome_driver_path&quot;</span><span class="p">,</span> <span class="s2">&quot;related_images&quot;</span><span class="p">,</span> <span class="s2">&quot;safe_search&quot;</span><span class="p">,</span> <span class="s2">&quot;no_numbering&quot;</span><span class="p">,</span>
             <span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="s2">&quot;no_download&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="user_input"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.user_input">[docs]</a><span class="k">def</span> <span class="nf">user_input</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse the configuration file of the arguments passed in command line. Behavior based of the configuration file</span>
<span class="sd">       specified in command line or programmatically in a python script.</span>
<span class="sd">       :return: A list of parameter that configure the application.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-cf&#39;</span><span class="p">,</span> <span class="s1">&#39;--config_file&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;config file name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">config_file_check</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">parse_known_args</span><span class="p">()</span>
    <span class="n">object_check</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">config_file_check</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">object_check</span><span class="p">[</span><span class="s1">&#39;config_file&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">json_file</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">config_file_check</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">config_file</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_file</span><span class="p">[</span><span class="s1">&#39;Records&#39;</span><span class="p">])):</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ARGS_LIST</span><span class="p">:</span>
                <span class="n">arguments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">json_file</span><span class="p">[</span><span class="s1">&#39;Records&#39;</span><span class="p">][</span><span class="n">record</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">arguments</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Taking command line arguments from users</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="s1">&#39;--keywords&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Delimited list input&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-kf&#39;</span><span class="p">,</span> <span class="s1">&#39;--keywords_from_file&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;extract list of keywords from a text file&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-sk&#39;</span><span class="p">,</span> <span class="s1">&#39;--suffix_keywords&#39;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Comma separated additional words added after to main keyword&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-pk&#39;</span><span class="p">,</span> <span class="s1">&#39;--prefix_keywords&#39;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Comma separated additional words added before main keyword&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="s1">&#39;--limit&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Delimited list input&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;--format&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Download images with specific format&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;gif&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="s1">&#39;bmp&#39;</span><span class="p">,</span> <span class="s1">&#39;svg&#39;</span><span class="p">,</span> <span class="s1">&#39;webp&#39;</span><span class="p">,</span> <span class="s1">&#39;ico&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-u&#39;</span><span class="p">,</span> <span class="s1">&#39;--url&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Search with google image URL&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-x&#39;</span><span class="p">,</span> <span class="s1">&#39;--single_image&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Downloading a single image from URL&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="s1">&#39;--output_directory&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Download images in a specific main directory&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--image_directory&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Download images in a specific sub-directory&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-n&#39;</span><span class="p">,</span> <span class="s1">&#39;--no_directory&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Download images in the main directory but no sub-directory&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;--delay&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Delay in seconds to wait between downloading two images&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-co&#39;</span><span class="p">,</span> <span class="s1">&#39;--color&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Filter on color&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ct&#39;</span><span class="p">,</span> <span class="s1">&#39;--color_type&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Filter on color&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;full-color&#39;</span><span class="p">,</span> <span class="s1">&#39;black-and-white&#39;</span><span class="p">,</span> <span class="s1">&#39;transparent&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;--usage_rights&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Usage rights&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;labeled-for-reuse-with-modifications&#39;</span><span class="p">,</span> <span class="s1">&#39;labeled-for-reuse&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;labeled-for-noncommercial-reuse-with-modification&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;labeled-for-nocommercial-reuse&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s1">&#39;--size&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Image size&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;400*300&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;640*480&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;800*600&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;1024*768&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;2MP&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;&gt;4MP&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;6MP&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;8MP&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;10MP&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;12MP&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;15MP&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;20MP&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;40MP&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;70MP&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-es&#39;</span><span class="p">,</span> <span class="s1">&#39;--exact_size&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Exact image resolution &quot;WIDTH,HEIGHT&quot;&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--type&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Image type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;face&#39;</span><span class="p">,</span> <span class="s1">&#39;photo&#39;</span><span class="p">,</span> <span class="s1">&#39;clipart&#39;</span><span class="p">,</span> <span class="s1">&#39;line-drawing&#39;</span><span class="p">,</span> <span class="s1">&#39;animated&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-w&#39;</span><span class="p">,</span> <span class="s1">&#39;--time&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Image age&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;past-24-hours&#39;</span><span class="p">,</span> <span class="s1">&#39;past-7-days&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-wr&#39;</span><span class="p">,</span> <span class="s1">&#39;--time_range&#39;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;time range for the age of the image. should be in the format </span><span class="se">\n</span><span class="s2"></span>
<span class="s2">                            {&quot;time_min&quot;:&quot;MM/DD/YYYY&quot;,&quot;time_max&quot;:&quot;MM/DD/YYYY&quot;}&quot;&quot;&quot;</span><span class="p">,</span>
                            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;--aspect_ratio&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Comma separated additional words added to keywords&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tall&#39;</span><span class="p">,</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;wide&#39;</span><span class="p">,</span> <span class="s1">&#39;panoramic&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-si&#39;</span><span class="p">,</span> <span class="s1">&#39;--similar_images&#39;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Downloads images very similar to the image URL you provide&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ss&#39;</span><span class="p">,</span> <span class="s1">&#39;--specific_site&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Downloads images that are indexed from a specific website&#39;</span><span class="p">,</span>
                            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--print_urls&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print the URLs of the images&quot;</span><span class="p">,</span>
                            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ps&#39;</span><span class="p">,</span> <span class="s1">&#39;--print_size&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print the size of the images on disk&quot;</span><span class="p">,</span>
                            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-pp&#39;</span><span class="p">,</span> <span class="s1">&#39;--print_paths&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Prints the list of absolute paths of the images&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="s1">&#39;--metadata&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print the metadata of the image&quot;</span><span class="p">,</span>
                            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-e&#39;</span><span class="p">,</span> <span class="s1">&#39;--extract_metadata&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Dumps all the logs into a text file&quot;</span><span class="p">,</span>
                            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-st&#39;</span><span class="p">,</span> <span class="s1">&#39;--socket_timeout&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Connection timeout waiting for the image to download&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-th&#39;</span><span class="p">,</span> <span class="s1">&#39;--thumbnail&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Downloads image thumbnail along with the actual image&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-la&#39;</span><span class="p">,</span> <span class="s1">&#39;--language&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Defines the language filter. The search results are authomatically returned in that language&quot;</span><span class="p">,</span>
                            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Arabic&#39;</span><span class="p">,</span> <span class="s1">&#39;Chinese (Simplified)&#39;</span><span class="p">,</span> <span class="s1">&#39;Chinese (Traditional)&#39;</span><span class="p">,</span> <span class="s1">&#39;Czech&#39;</span><span class="p">,</span> <span class="s1">&#39;Danish&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Dutch&#39;</span><span class="p">,</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="s1">&#39;Estonian&#39;</span><span class="p">,</span> <span class="s1">&#39;Finnish&#39;</span><span class="p">,</span> <span class="s1">&#39;French&#39;</span><span class="p">,</span> <span class="s1">&#39;German&#39;</span><span class="p">,</span> <span class="s1">&#39;Greek&#39;</span><span class="p">,</span> <span class="s1">&#39;Hebrew&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Hungarian&#39;</span><span class="p">,</span> <span class="s1">&#39;Icelandic&#39;</span><span class="p">,</span> <span class="s1">&#39;Italian&#39;</span><span class="p">,</span> <span class="s1">&#39;Japanese&#39;</span><span class="p">,</span> <span class="s1">&#39;Korean&#39;</span><span class="p">,</span> <span class="s1">&#39;Latvian&#39;</span><span class="p">,</span> <span class="s1">&#39;Lithuanian&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Norwegian&#39;</span><span class="p">,</span> <span class="s1">&#39;Portuguese&#39;</span><span class="p">,</span> <span class="s1">&#39;Polish&#39;</span><span class="p">,</span> <span class="s1">&#39;Romanian&#39;</span><span class="p">,</span> <span class="s1">&#39;Russian&#39;</span><span class="p">,</span> <span class="s1">&#39;Spanish&#39;</span><span class="p">,</span> <span class="s1">&#39;Swedish&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Turkish&#39;</span><span class="p">])</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-pr&#39;</span><span class="p">,</span> <span class="s1">&#39;--prefix&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;A word that you would want to prefix in front of each image name&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-px&#39;</span><span class="p">,</span> <span class="s1">&#39;--proxy&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;specify a proxy address and port&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-cd&#39;</span><span class="p">,</span> <span class="s1">&#39;--chrome_driver_path&#39;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;specify the path to chrome_driver_path executable in your local machine&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-ri&#39;</span><span class="p">,</span> <span class="s1">&#39;--related_images&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Downloads images that are similar to the keyword provided&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-sa&#39;</span><span class="p">,</span> <span class="s1">&#39;--safe_search&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Turns on the safe search filter while searching for images&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-nn&#39;</span><span class="p">,</span> <span class="s1">&#39;--no_numbering&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Allows you to exclude the default numbering of images&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-of&#39;</span><span class="p">,</span> <span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Where to start in the fetched links&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-nd&#39;</span><span class="p">,</span> <span class="s1">&#39;--no_download&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Prints the URLs of the images and/or thumbnails without downloading them&quot;</span><span class="p">,</span>
                            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">)</span>

        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">records</span></div>


<div class="viewcode-block" id="GoogleImageDownloadException"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownloadException">[docs]</a><span class="k">class</span> <span class="nc">GoogleImageDownloadException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specific exception of the GoogleImageDownload class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="GoogleImageDownload"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload">[docs]</a><span class="k">class</span> <span class="nc">GoogleImageDownload</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main class of this data creator. The one to call directly within a script.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument_or_configuration</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor of the main class taking the configuration of any download.</span>
<span class="sd">           :parameter argument_or_configuration: Arguments programmaticaly passed or from arguments in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument_or_configuration</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">argument_or_configuration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Configuration passed to to the constructor must be dict type.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="GoogleImageDownload.download_page"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.download_page">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">download_page</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloading entire Web Document (Raw Page Content).</span>
<span class="sd">           :parameter url: URL of tha page.</span>
<span class="sd">           :return: Source code the page.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">headers</span><span class="p">[</span>
                <span class="s1">&#39;User-Agent&#39;</span><span class="p">]</span> \
                <span class="o">=</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36&quot;</span>
            <span class="n">req</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
            <span class="n">response_data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">response_data</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Could not open URL. Please check your internet connection and/or ssl settings, error message is: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span></div>

<div class="viewcode-block" id="GoogleImageDownload.download_extended_page"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.download_extended_page">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">download_extended_page</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">chrome_driver_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If more than 100 image are downloaded.</span>
<span class="sd">           :parameter url: Page URL to parse</span>
<span class="sd">           :parameter chrome_driver_path: Path to the chrome driver</span>
<span class="sd">           :return: Page source</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
        <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--no-sandbox&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--headless&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">chrome_driver_path</span><span class="p">,</span> <span class="n">chrome_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Fail to locate the chrome driver &#39;chrome_driver_path&#39;, error message is: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="n">browser</span><span class="o">.</span><span class="n">set_window_size</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>

        <span class="c1"># Open the link</span>
        <span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting you a lot of images. This may take a few moments...&quot;</span><span class="p">)</span>

        <span class="n">element</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_tag_name</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">)</span>
        <span class="c1"># Scroll down</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">PAGE_DOWN</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&quot;smb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
                <span class="n">element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">PAGE_DOWN</span><span class="p">)</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>  <span class="c1"># bot id protection</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">PAGE_DOWN</span><span class="p">)</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>  <span class="c1"># bot id protection</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reached end of Page.&quot;</span><span class="p">)</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="n">source</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">page_source</span>  <span class="c1"># page source</span>
        <span class="c1"># close the browser</span>
        <span class="n">browser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">source</span></div>

<div class="viewcode-block" id="GoogleImageDownload.get_next_tab"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.get_next_tab">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_next_tab</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finding &#39;Next Image&#39; from the given raw page</span>
<span class="sd">           :parameter source: Source of the URL.</span>
<span class="sd">           :return: A tuple made of the URL of the item, it&#39;s name and the end content.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_line</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;class=&quot;dtviD&quot;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_line</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># If no links are found then give an error!</span>
            <span class="n">end_quote</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">link</span> <span class="o">=</span> <span class="s2">&quot;no_tabs&quot;</span>
            <span class="k">return</span> <span class="n">link</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end_quote</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start_line</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;class=&quot;dtviD&quot;&#39;</span><span class="p">)</span>
            <span class="n">start_content</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;href=&quot;&#39;</span><span class="p">,</span> <span class="n">start_line</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">end_content</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">,</span> <span class="n">start_content</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">url_item</span> <span class="o">=</span> <span class="s2">&quot;https://www.google.com&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="n">start_content</span> <span class="o">+</span> <span class="mi">6</span><span class="p">:</span><span class="n">end_content</span><span class="p">])</span>
            <span class="n">url_item</span> <span class="o">=</span> <span class="n">url_item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&amp;amp;&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">)</span>

            <span class="n">start_line_2</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;class=&quot;dtviD&quot;&#39;</span><span class="p">)</span>
            <span class="n">start_content_2</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">start_line_2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">end_content_2</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="n">start_content_2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">url_item_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="n">start_content_2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">end_content_2</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">url_item</span><span class="p">,</span> <span class="n">url_item_name</span><span class="p">,</span> <span class="n">end_content</span></div>

<div class="viewcode-block" id="GoogleImageDownload.get_all_tabs"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.get_all_tabs">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_all_tabs</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Getting all links with the help of &#39;_images_get_next_image&#39;.</span>
<span class="sd">           :parameter page: Page to parse.</span>
<span class="sd">           :return: Link in the page.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tabs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">item</span><span class="p">,</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">end_content</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">get_next_tab</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="s2">&quot;no_tabs&quot;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tabs</span><span class="p">[</span><span class="n">item_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>  <span class="c1"># Append all the links in the list named &#39;Links&#39;</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># Timer could be used to slow down the request for image downloads</span>
                <span class="n">page</span> <span class="o">=</span> <span class="n">page</span><span class="p">[</span><span class="n">end_content</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">tabs</span></div>

<div class="viewcode-block" id="GoogleImageDownload.format_object"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.format_object">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">format_object</span><span class="p">(</span><span class="n">object_2_format</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format the object in readable format</span>
<span class="sd">           :parameter object_2_format: Object to format.</span>
<span class="sd">           :return: The formatted object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">formatted_object</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">formatted_object</span><span class="p">[</span><span class="s1">&#39;image_format&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_2_format</span><span class="p">[</span><span class="s1">&#39;ity&#39;</span><span class="p">]</span>
        <span class="n">formatted_object</span><span class="p">[</span><span class="s1">&#39;image_height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_2_format</span><span class="p">[</span><span class="s1">&#39;oh&#39;</span><span class="p">]</span>
        <span class="n">formatted_object</span><span class="p">[</span><span class="s1">&#39;image_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_2_format</span><span class="p">[</span><span class="s1">&#39;ow&#39;</span><span class="p">]</span>
        <span class="n">formatted_object</span><span class="p">[</span><span class="s1">&#39;image_link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_2_format</span><span class="p">[</span><span class="s1">&#39;ou&#39;</span><span class="p">]</span>
        <span class="n">formatted_object</span><span class="p">[</span><span class="s1">&#39;image_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_2_format</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">]</span>
        <span class="n">formatted_object</span><span class="p">[</span><span class="s1">&#39;image_host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_2_format</span><span class="p">[</span><span class="s1">&#39;rh&#39;</span><span class="p">]</span>
        <span class="n">formatted_object</span><span class="p">[</span><span class="s1">&#39;image_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_2_format</span><span class="p">[</span><span class="s1">&#39;ru&#39;</span><span class="p">]</span>
        <span class="n">formatted_object</span><span class="p">[</span><span class="s1">&#39;image_thumbnail_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_2_format</span><span class="p">[</span><span class="s1">&#39;tu&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">formatted_object</span></div>

<div class="viewcode-block" id="GoogleImageDownload.single_image"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.single_image">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">single_image</span><span class="p">(</span><span class="n">image_url</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to download single image.</span>
<span class="sd">           :parameter image_url: URL of the image.</span>
<span class="sd">           :return: Nothing to be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">main_directory</span> <span class="o">=</span> <span class="s2">&quot;downloads&quot;</span>
        <span class="n">extensions</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;.jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="s2">&quot;.bmp&quot;</span><span class="p">,</span> <span class="s2">&quot;.svg&quot;</span><span class="p">,</span> <span class="s2">&quot;.webp&quot;</span><span class="p">,</span> <span class="s2">&quot;.ico&quot;</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">image_url</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">main_directory</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="mi">17</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="k">pass</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;User-Agent&quot;</span>
            <span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.27 Safari/537.17&quot;</span><span class="p">})</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">response</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">image_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">url</span><span class="p">[(</span><span class="n">url</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">image_name</span><span class="p">:</span>
            <span class="n">image_name</span> <span class="o">=</span> <span class="n">image_name</span><span class="p">[:</span><span class="n">image_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">extension</span><span class="p">:</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">image_name</span><span class="p">,</span> <span class="n">extensions</span><span class="p">)):</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">main_directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">image_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">main_directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">image_name</span> <span class="o">+</span> <span class="s2">&quot;.jpg&quot;</span>
            <span class="n">image_name</span> <span class="o">=</span> <span class="n">image_name</span> <span class="o">+</span> <span class="s2">&quot;.jpg&quot;</span>

        <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;completed ====&gt; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">image_name</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="GoogleImageDownload.similar_images"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.similar_images">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">similar_images</span><span class="p">(</span><span class="n">similar_images</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find images to download with a URL as reference instead of a keyword.</span>
<span class="sd">           :parameter similar_images: URL</span>
<span class="sd">           :return: URL content.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_url</span> <span class="o">=</span> <span class="s1">&#39;https://www.google.com/searchbyimage?site=search&amp;sa=X&amp;image_url=&#39;</span> <span class="o">+</span> <span class="n">similar_images</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">headers</span><span class="p">[</span>
                <span class="s1">&#39;User-Agent&#39;</span><span class="p">]</span> \
                <span class="o">=</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36&quot;</span>

            <span class="n">req1</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">search_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
            <span class="n">resp1</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req1</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">resp1</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

            <span class="n">length_3</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;/search?sa=X&amp;amp;q=&#39;</span><span class="p">)</span>
            <span class="n">length_4</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">length_3</span> <span class="o">+</span> <span class="mi">19</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="n">length_3</span> <span class="o">+</span> <span class="mi">19</span><span class="p">:</span><span class="n">length_4</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">url</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Could not connect to Google Images endpoint&quot;</span></div>

<div class="viewcode-block" id="GoogleImageDownload.build_url_parameters"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.build_url_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">build_url_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Building URL parameters.</span>
<span class="sd">           :return: The URL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]:</span>
            <span class="n">lang</span> <span class="o">=</span> <span class="s2">&quot;&amp;lr=&quot;</span>
            <span class="n">lang_param</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Arabic&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_ar&quot;</span><span class="p">,</span> <span class="s2">&quot;Chinese (Simplified)&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_zh-CN&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Chinese (Traditional)&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_zh-TW&quot;</span><span class="p">,</span> <span class="s2">&quot;Czech&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_cs&quot;</span><span class="p">,</span> <span class="s2">&quot;Danish&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_da&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Dutch&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_nl&quot;</span><span class="p">,</span> <span class="s2">&quot;English&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_en&quot;</span><span class="p">,</span> <span class="s2">&quot;Estonian&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_et&quot;</span><span class="p">,</span> <span class="s2">&quot;Finnish&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_fi&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;French&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;German&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_de&quot;</span><span class="p">,</span> <span class="s2">&quot;Greek&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_el&quot;</span><span class="p">,</span> <span class="s2">&quot;Hebrew&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_iw &quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Hungarian&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_hu&quot;</span><span class="p">,</span> <span class="s2">&quot;Icelandic&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_is&quot;</span><span class="p">,</span> <span class="s2">&quot;Italian&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_it&quot;</span><span class="p">,</span> <span class="s2">&quot;Japanese&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_ja&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Korean&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_ko&quot;</span><span class="p">,</span> <span class="s2">&quot;Latvian&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_lv&quot;</span><span class="p">,</span> <span class="s2">&quot;Lithuanian&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_lt&quot;</span><span class="p">,</span> <span class="s2">&quot;Norwegian&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_no&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Portuguese&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_pt&quot;</span><span class="p">,</span> <span class="s2">&quot;Polish&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_pl&quot;</span><span class="p">,</span> <span class="s2">&quot;Romanian&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_ro&quot;</span><span class="p">,</span> <span class="s2">&quot;Russian&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_ru&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Spanish&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_es&quot;</span><span class="p">,</span> <span class="s2">&quot;Swedish&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_sv&quot;</span><span class="p">,</span> <span class="s2">&quot;Turkish&quot;</span><span class="p">:</span> <span class="s2">&quot;lang_tr&quot;</span><span class="p">}</span>
            <span class="n">lang_url</span> <span class="o">=</span> <span class="n">lang</span> <span class="o">+</span> <span class="n">lang_param</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lang_url</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;time_range&#39;</span><span class="p">]:</span>
            <span class="n">time_range</span> <span class="o">=</span> <span class="s1">&#39;,cdr:1,cd_min:&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;time_range&#39;</span><span class="p">][</span><span class="s1">&#39;time_min&#39;</span><span class="p">]</span> \
                         <span class="o">+</span> <span class="s1">&#39;,cd_max:&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;time_range&#39;</span><span class="p">][</span><span class="s1">&#39;time_max&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time_range</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;exact_size&#39;</span><span class="p">]:</span>
            <span class="n">size_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;exact_size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
            <span class="n">exact_size</span> <span class="o">=</span> <span class="s2">&quot;,isz:ex,iszw:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">size_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;,iszh:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">size_array</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exact_size</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="n">built_url</span> <span class="o">=</span> <span class="s2">&quot;&amp;tbs=&quot;</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:orange&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;yellow&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:yellow&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:green&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;teal&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:teel&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:blue&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;purple&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:purple&#39;</span><span class="p">,</span> <span class="s1">&#39;pink&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:pink&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;white&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:white&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:gray&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;black&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:black&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;brown&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:specific,isc:brown&#39;</span><span class="p">}],</span>
            <span class="s1">&#39;color_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;color_type&#39;</span><span class="p">],</span>
                           <span class="p">{</span><span class="s1">&#39;full-color&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:color&#39;</span><span class="p">,</span> <span class="s1">&#39;black-and-white&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:gray&#39;</span><span class="p">,</span> <span class="s1">&#39;transparent&#39;</span><span class="p">:</span> <span class="s1">&#39;ic:trans&#39;</span><span class="p">}],</span>
            <span class="s1">&#39;usage_rights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;usage_rights&#39;</span><span class="p">],</span>
                             <span class="p">{</span><span class="s1">&#39;labeled-for-reuse-with-modifications&#39;</span><span class="p">:</span> <span class="s1">&#39;sur:fmc&#39;</span><span class="p">,</span> <span class="s1">&#39;labeled-for-reuse&#39;</span><span class="p">:</span> <span class="s1">&#39;sur:fc&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;labeled-for-noncommercial-reuse-with-modification&#39;</span><span class="p">:</span> <span class="s1">&#39;sur:fm&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;labeled-for-nocommercial-reuse&#39;</span><span class="p">:</span> <span class="s1">&#39;sur:f&#39;</span><span class="p">}],</span>
            <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">],</span>
                     <span class="p">{</span><span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:l&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:m&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:i&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;400*300&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:qsvga&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;&gt;640*480&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:vga&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;800*600&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:svga&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;&gt;1024*768&#39;</span><span class="p">:</span> <span class="s1">&#39;visz:lt,islt:xga&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;2MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:2mp&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;4MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:4mp&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;&gt;6MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:6mp&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;8MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:8mp&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;10MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:10mp&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;&gt;12MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:12mp&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;15MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:15mp&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;20MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:20mp&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;&gt;40MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:40mp&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;70MP&#39;</span><span class="p">:</span> <span class="s1">&#39;isz:lt,islt:70mp&#39;</span><span class="p">}],</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;face&#39;</span><span class="p">:</span> <span class="s1">&#39;itp:face&#39;</span><span class="p">,</span> <span class="s1">&#39;photo&#39;</span><span class="p">:</span> <span class="s1">&#39;itp:photo&#39;</span><span class="p">,</span> <span class="s1">&#39;clipart&#39;</span><span class="p">:</span> <span class="s1">&#39;itp:clipart&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;line-drawing&#39;</span><span class="p">:</span> <span class="s1">&#39;itp:lineart&#39;</span><span class="p">,</span> <span class="s1">&#39;animated&#39;</span><span class="p">:</span> <span class="s1">&#39;itp:animated&#39;</span><span class="p">}],</span>
            <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;past-24-hours&#39;</span><span class="p">:</span> <span class="s1">&#39;qdr:d&#39;</span><span class="p">,</span> <span class="s1">&#39;past-7-days&#39;</span><span class="p">:</span> <span class="s1">&#39;qdr:w&#39;</span><span class="p">}],</span>
            <span class="s1">&#39;aspect_ratio&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;aspect_ratio&#39;</span><span class="p">],</span>
                             <span class="p">{</span><span class="s1">&#39;tall&#39;</span><span class="p">:</span> <span class="s1">&#39;iar:t&#39;</span><span class="p">,</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span> <span class="s1">&#39;iar:s&#39;</span><span class="p">,</span> <span class="s1">&#39;wide&#39;</span><span class="p">:</span> <span class="s1">&#39;iar:w&#39;</span><span class="p">,</span> <span class="s1">&#39;panoramic&#39;</span><span class="p">:</span> <span class="s1">&#39;iar:xw&#39;</span><span class="p">}],</span>
            <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">],</span>
                       <span class="p">{</span><span class="s1">&#39;jpg&#39;</span><span class="p">:</span> <span class="s1">&#39;ift:jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;gif&#39;</span><span class="p">:</span> <span class="s1">&#39;ift:gif&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">:</span> <span class="s1">&#39;ift:png&#39;</span><span class="p">,</span> <span class="s1">&#39;bmp&#39;</span><span class="p">:</span> <span class="s1">&#39;ift:bmp&#39;</span><span class="p">,</span> <span class="s1">&#39;svg&#39;</span><span class="p">:</span> <span class="s1">&#39;ift:svg&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;webp&#39;</span><span class="p">:</span> <span class="s1">&#39;webp&#39;</span><span class="p">,</span> <span class="s1">&#39;ico&#39;</span><span class="p">:</span> <span class="s1">&#39;ift:ico&#39;</span><span class="p">}]}</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ext_param</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="c1"># counter will tell if it is first param added or not</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># add it to the built url</span>
                    <span class="n">built_url</span> <span class="o">=</span> <span class="n">built_url</span> <span class="o">+</span> <span class="n">ext_param</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">built_url</span> <span class="o">=</span> <span class="n">built_url</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">ext_param</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">built_url</span> <span class="o">=</span> <span class="n">lang_url</span> <span class="o">+</span> <span class="n">built_url</span> <span class="o">+</span> <span class="n">exact_size</span> <span class="o">+</span> <span class="n">time_range</span>
        <span class="k">return</span> <span class="n">built_url</span></div>

<div class="viewcode-block" id="GoogleImageDownload.build_search_url"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.build_search_url">[docs]</a>    <span class="k">def</span> <span class="nf">build_search_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_term</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">similar_images</span><span class="p">,</span> <span class="n">specific_site</span><span class="p">,</span> <span class="n">safe_search</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Building main search URL.</span>
<span class="sd">           :parameter search_term: Term to search.</span>
<span class="sd">           :parameter params: parameters of the search.</span>
<span class="sd">           :parameter url: URL to search.</span>
<span class="sd">           :parameter similar_images: Image to base the search on.</span>
<span class="sd">           :parameter specific_site: Search on that specific site.</span>
<span class="sd">           :parameter safe_search: Safe search of google.</span>
<span class="sd">           :return: The created URL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check safe_search</span>
        <span class="n">safe_search_string</span> <span class="o">=</span> <span class="s2">&quot;&amp;safe=active&quot;</span>
        <span class="c1"># check the args and choose the URL</span>
        <span class="k">if</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
        <span class="k">elif</span> <span class="n">similar_images</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">similar_images</span><span class="p">)</span>
            <span class="n">keyword</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similar_images</span><span class="p">(</span><span class="n">similar_images</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.google.com/search?q=&#39;</span> \
                  <span class="o">+</span> <span class="n">keyword</span> \
                  <span class="o">+</span> <span class="s1">&#39;&amp;espv=2&amp;biw=1366&amp;bih=667&amp;site=webhp&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ei=XosDVaCXD8TasATItgE&amp;ved=0CAcQ_AUoAg&#39;</span>
        <span class="k">elif</span> <span class="n">specific_site</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.google.com/search?q=&#39;</span> <span class="o">+</span> <span class="n">quote</span><span class="p">(</span>
                <span class="n">search_term</span><span class="p">)</span> \
                  <span class="o">+</span> <span class="s1">&#39;&amp;as_sitesearch=&#39;</span> \
                  <span class="o">+</span> <span class="n">specific_site</span> \
                  <span class="o">+</span> <span class="s1">&#39;&amp;espv=2&amp;biw=1366&amp;bih=667&amp;site=webhp&amp;source=lnms&amp;tbm=isch&#39;</span> \
                  <span class="o">+</span> <span class="n">params</span> \
                  <span class="o">+</span> <span class="s1">&#39;&amp;sa=X&amp;ei=XosDVaCXD8TasATItgE&amp;ved=0CAcQ_AUoAg&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.google.com/search?q=&#39;</span> <span class="o">+</span> <span class="n">quote</span><span class="p">(</span>
                <span class="n">search_term</span><span class="p">)</span> \
                  <span class="o">+</span> <span class="s1">&#39;&amp;espv=2&amp;biw=1366&amp;bih=667&amp;site=webhp&amp;source=lnms&amp;tbm=isch&#39;</span> \
                  <span class="o">+</span> <span class="n">params</span> \
                  <span class="o">+</span> <span class="s1">&#39;&amp;sa=X&amp;ei=XosDVaCXD8TasATItgE&amp;ved=0CAcQ_AUoAg&#39;</span>

        <span class="c1"># safe search check</span>
        <span class="k">if</span> <span class="n">safe_search</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">safe_search_string</span>

        <span class="c1"># print(url)</span>
        <span class="k">return</span> <span class="n">url</span></div>

<div class="viewcode-block" id="GoogleImageDownload.file_size"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.file_size">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">file_size</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Measures the file size of the downloaded images.</span>
<span class="sd">           :parameter file_path: File path of the download images.</span>
<span class="sd">           :return: A string representing the size.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
            <span class="n">file_info</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">st_size</span>
            <span class="k">for</span> <span class="n">size_unit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;KB&#39;</span><span class="p">,</span> <span class="s1">&#39;MB&#39;</span><span class="p">,</span> <span class="s1">&#39;GB&#39;</span><span class="p">,</span> <span class="s1">&#39;TB&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mf">1024.0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%3.1f</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size_unit</span><span class="p">)</span>
                <span class="n">size</span> <span class="o">/=</span> <span class="mf">1024.0</span>
            <span class="k">return</span> <span class="n">size</span></div>

<div class="viewcode-block" id="GoogleImageDownload.keywords_from_file"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.keywords_from_file">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">keywords_from_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a keyword from a file.</span>
<span class="sd">           :parameter file_name: String of the image file name.</span>
<span class="sd">           :return: A string representing the keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">search_keyword</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">keyword_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;.csv&#39;</span> <span class="ow">in</span> <span class="n">file_name</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">keyword_file</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">]:</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">search_keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">elif</span> <span class="s1">&#39;.txt&#39;</span> <span class="ow">in</span> <span class="n">file_name</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">keyword_file</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">]:</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">search_keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid file type: Valid file types are either .txt or .csv exiting...&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">search_keyword</span></div>

<div class="viewcode-block" id="GoogleImageDownload.create_directories"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.create_directories">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_directories</span><span class="p">(</span><span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">thumbnail</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create directories based on the arguments.</span>
<span class="sd">           :parameter main_directory: Main directory where all the images are based.</span>
<span class="sd">           :parameter dir_name: Subdirectory where images are classified by keyword.</span>
<span class="sd">           :parameter thumbnail: Subdirectory for thumbnail.</span>
<span class="sd">           :return: Nothing to be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dir_name_thumbnail</span> <span class="o">=</span> <span class="n">dir_name</span> <span class="o">+</span> <span class="s2">&quot; - thumbnail&quot;</span>
        <span class="c1"># make a search keyword  directory</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">main_directory</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">main_directory</span><span class="p">)</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
                <span class="n">path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
                <span class="n">sub_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">main_directory</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sub_directory</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">sub_directory</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">thumbnail</span><span class="p">:</span>
                    <span class="n">sub_directory_thumbnail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name_thumbnail</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sub_directory_thumbnail</span><span class="p">):</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">sub_directory_thumbnail</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
                <span class="n">sub_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">main_directory</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sub_directory</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">sub_directory</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">thumbnail</span><span class="p">:</span>
                    <span class="n">sub_directory_thumbnail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name_thumbnail</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sub_directory_thumbnail</span><span class="p">):</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">sub_directory_thumbnail</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="mi">17</span><span class="p">:</span>
                <span class="k">raise</span>
                <span class="c1"># sleep might help here</span>
            <span class="k">pass</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="GoogleImageDownload.download_image_thumbnail"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.download_image_thumbnail">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">download_image_thumbnail</span><span class="p">(</span><span class="n">image_url</span><span class="p">,</span> <span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">return_image_name</span><span class="p">,</span> <span class="n">print_urls</span><span class="p">,</span>
                                 <span class="n">socket_timeout</span><span class="p">,</span> <span class="n">print_size</span><span class="p">,</span> <span class="n">no_download</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Download the image thumbnail.</span>
<span class="sd">           :parameter image_url: URL of the image.</span>
<span class="sd">           :parameter main_directory: Main directory where all the images are saved.</span>
<span class="sd">           :parameter dir_name: Name of the subdirectory based on a keyword.</span>
<span class="sd">           :parameter return_image_name: Name of the image.</span>
<span class="sd">           :parameter print_urls: Argument for printing the URL or not.</span>
<span class="sd">           :parameter socket_timeout: Timeout of the socket.</span>
<span class="sd">           :parameter print_size: Argument for printing the size or not.</span>
<span class="sd">           :parameter no_download: Number of download.</span>
<span class="sd">           :return: A tuple made of the download status and the downlaod message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">print_urls</span> <span class="ow">or</span> <span class="n">no_download</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Image URL: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">image_url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_download</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Printed url without downloading&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">image_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span>
                    <span class="s2">&quot;Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.27 Safari/537.17&quot;</span><span class="p">})</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># timeout time to download an image</span>
                <span class="k">if</span> <span class="n">socket_timeout</span><span class="p">:</span>
                    <span class="n">timeout</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">socket_timeout</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">timeout</span> <span class="o">=</span> <span class="mi">10</span>

                <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">response</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="n">path</span> <span class="o">=</span> <span class="n">main_directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">dir_name</span> <span class="o">+</span> <span class="s2">&quot; - thumbnail&quot;</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">return_image_name</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>
                    <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;Completed Image Thumbnail ====&gt; &quot;</span> <span class="o">+</span> <span class="n">return_image_name</span>
                <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                    <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
                    <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;OSError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                    <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
                    <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;IOError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

                <span class="c1"># image size parameter</span>
                <span class="k">if</span> <span class="n">print_size</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Image Size: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">file_size</span><span class="p">(</span><span class="n">path</span><span class="p">)))</span>

            <span class="k">except</span> <span class="ne">UnicodeEncodeError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
                <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;UnicodeEncodeError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>  <span class="c1"># If there is any HTTPError</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;HTTPError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;URLError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CertificateError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;CertificateError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>  <span class="c1"># If there is any IOError</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;IOError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">download_status</span><span class="p">,</span> <span class="n">download_message</span></div>

<div class="viewcode-block" id="GoogleImageDownload.download_image"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.download_image">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">download_image</span><span class="p">(</span><span class="n">image_url</span><span class="p">,</span> <span class="n">image_format</span><span class="p">,</span> <span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">print_urls</span><span class="p">,</span> <span class="n">socket_timeout</span><span class="p">,</span>
                       <span class="n">prefix</span><span class="p">,</span> <span class="n">print_size</span><span class="p">,</span> <span class="n">no_numbering</span><span class="p">,</span> <span class="n">no_download</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Download image from google image page.</span>
<span class="sd">           :parameter image_url: URL of the image.</span>
<span class="sd">           :parameter image_format: Format of the image.</span>
<span class="sd">           :parameter main_directory: Main directory where all the image are stored.</span>
<span class="sd">           :parameter dir_name: Subdirectory where images are classified by keyword.</span>
<span class="sd">           :parameter count: Counter of the number of images.</span>
<span class="sd">           :parameter print_urls: Argument for printing the URL of the image or not.</span>
<span class="sd">           :parameter socket_timeout: Timeout to close connection.</span>
<span class="sd">           :parameter prefix: Prefix the image name.</span>
<span class="sd">           :parameter print_size: Argument for printing the size of the image or not.</span>
<span class="sd">           :parameter no_numbering: Adding the number in the image name or not.</span>
<span class="sd">           :parameter no_download: Argument defining if the image is to be downloaded or not.</span>
<span class="sd">           :return: A tuple made of the download status, the download message, the image name and the absolute path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">print_urls</span> <span class="ow">or</span> <span class="n">no_download</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Image URL: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">image_url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_download</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Printed url without downloading&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">image_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span>
                    <span class="s2">&quot;Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.27 Safari/537.17&quot;</span><span class="p">})</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># timeout time to download an image</span>
                <span class="k">if</span> <span class="n">socket_timeout</span><span class="p">:</span>
                    <span class="n">timeout</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">socket_timeout</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">timeout</span> <span class="o">=</span> <span class="mi">10</span>

                <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">response</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="c1"># keep everything after the last &#39;/&#39;</span>
                <span class="n">image_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_url</span><span class="p">[(</span><span class="n">image_url</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])</span>
                <span class="n">image_name</span> <span class="o">=</span> <span class="n">image_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="c1"># if no extension then add it</span>
                <span class="c1"># remove everything after the image name</span>
                <span class="k">if</span> <span class="n">image_format</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">image_name</span> <span class="o">=</span> <span class="n">image_name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="s2">&quot;jpg&quot;</span>
                <span class="k">elif</span> <span class="n">image_format</span> <span class="o">==</span> <span class="s2">&quot;jpeg&quot;</span><span class="p">:</span>
                    <span class="n">image_name</span> <span class="o">=</span> <span class="n">image_name</span><span class="p">[:</span><span class="n">image_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">image_format</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">image_name</span> <span class="o">=</span> <span class="n">image_name</span><span class="p">[:</span><span class="n">image_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">image_format</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>

                <span class="c1"># prefix name in image</span>
                <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
                    <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                <span class="k">if</span> <span class="n">no_numbering</span><span class="p">:</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">main_directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">dir_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">image_name</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">main_directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">dir_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_ &quot;</span> <span class="o">+</span> <span class="n">image_name</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="n">absolute_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                    <span class="n">absolute_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                <span class="c1"># return image name back to calling method to use it for thumbnail downloads</span>
                <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>
                <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;Completed Image ====&gt; &quot;</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_ &quot;</span> <span class="o">+</span> <span class="n">image_name</span>
                <span class="n">return_image_name</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_ &quot;</span> <span class="o">+</span> <span class="n">image_name</span>  <span class="c1"># _ instead of . to preserve extensions.</span>

                <span class="c1"># image size parameter</span>
                <span class="k">if</span> <span class="n">print_size</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Image Size: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">file_size</span><span class="p">(</span><span class="n">path</span><span class="p">)))</span>

            <span class="k">except</span> <span class="ne">UnicodeEncodeError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
                <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;UnicodeEncodeError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
                <span class="n">return_image_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">absolute_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

            <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
                <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;URLError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
                <span class="n">return_image_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">absolute_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>  <span class="c1"># If there is any HTTPError</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;HTTPError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">return_image_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">absolute_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;URLError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">return_image_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">absolute_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">except</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CertificateError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;CertificateError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">return_image_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">absolute_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>  <span class="c1"># If there is any IOError</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;IOError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">return_image_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">absolute_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">except</span> <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">IncompleteRead</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">download_status</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">download_message</span> <span class="o">=</span> <span class="s2">&quot;IncompleteReadError on an image...trying next one...&quot;</span> <span class="o">+</span> <span class="s2">&quot; Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">return_image_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">absolute_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">return</span> <span class="n">download_status</span><span class="p">,</span> <span class="n">download_message</span><span class="p">,</span> <span class="n">return_image_name</span><span class="p">,</span> <span class="n">absolute_path</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_next_item</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse the source of the page for the next image.</span>
<span class="sd">           :parameter source: Source.</span>
<span class="sd">           :return: A tuple made of the final object and the end object;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_line</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;rg_meta notranslate&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_line</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># If no links are found then give an error!</span>
            <span class="n">end_quote</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">link</span> <span class="o">=</span> <span class="s2">&quot;no_links&quot;</span>
            <span class="k">return</span> <span class="n">link</span><span class="p">,</span> <span class="n">end_quote</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start_line</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;class=&quot;rg_meta notranslate&quot;&gt;&#39;</span><span class="p">)</span>
            <span class="n">start_object</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="n">start_line</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">end_object</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span> <span class="n">start_object</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">object_raw</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="n">start_object</span><span class="p">:</span><span class="n">end_object</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">object_decode</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">object_raw</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;unicode_escape&quot;</span><span class="p">)</span>
                <span class="n">final_object</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">object_decode</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">final_object</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">return</span> <span class="n">final_object</span><span class="p">,</span> <span class="n">end_object</span>

    <span class="k">def</span> <span class="nf">_get_all_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">limit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Getting all links with the help of &#39;_images_get_next_image&#39;.</span>
<span class="sd">           :parameter page: Page to parse.</span>
<span class="sd">           :parameter main_directory: Main directory of the images.</span>
<span class="sd">           :parameter dir_name: Directory of the image in the main directory.</span>
<span class="sd">           :parameter limit: Limit number of images to download.</span>
<span class="sd">           :return: A tuple made of the images, the absolute path of the images and the number of errors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">abs_path</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">error_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">limit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">item</span><span class="p">,</span> <span class="n">end_content</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">_get_next_item</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="s2">&quot;no_links&quot;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">page</span> <span class="o">=</span> <span class="n">page</span><span class="p">[</span><span class="n">end_content</span><span class="p">:]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">]):</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">page</span> <span class="o">=</span> <span class="n">page</span><span class="p">[</span><span class="n">end_content</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># format the item for readability</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">format_object</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Image Metadata: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

                <span class="c1"># download the images</span>
                <span class="n">download_status</span><span class="p">,</span> <span class="n">download_message</span><span class="p">,</span> <span class="n">return_image_name</span><span class="p">,</span> <span class="n">absolute_path</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">download_image</span><span class="p">(</span>
                    <span class="n">item</span><span class="p">[</span><span class="s1">&#39;image_link&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;image_format&#39;</span><span class="p">],</span> <span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;print_urls&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;socket_timeout&#39;</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;prefix&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;print_size&#39;</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;no_numbering&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;no_download&#39;</span><span class="p">])</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">download_message</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">download_status</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>

                    <span class="c1"># download image_thumbnails</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;thumbnail&#39;</span><span class="p">]:</span>
                        <span class="n">download_status</span><span class="p">,</span> <span class="n">download_message_thumbnail</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">download_image_thumbnail</span><span class="p">(</span>
                            <span class="n">item</span><span class="p">[</span><span class="s1">&#39;image_thumbnail_url&#39;</span><span class="p">],</span> <span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">return_image_name</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;print_urls&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;socket_timeout&#39;</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;print_size&#39;</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;no_download&#39;</span><span class="p">])</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">download_message_thumbnail</span><span class="p">)</span>

                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">item</span><span class="p">[</span><span class="s1">&#39;image_filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">return_image_name</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># Append all the links in the list named &#39;Links&#39;</span>
                    <span class="n">abs_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">absolute_path</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">error_count</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># delay param</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]:</span>
                    <span class="n">sleep</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]))</span>

                <span class="n">page</span> <span class="o">=</span> <span class="n">page</span><span class="p">[</span><span class="n">end_content</span><span class="p">:]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;All </span><span class="si">%d</span><span class="s2"> were not downloaded. Only </span><span class="si">%d</span><span class="s2"> we got for this search filter!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">items</span><span class="p">,</span> <span class="n">error_count</span><span class="p">,</span> <span class="n">abs_path</span>

<div class="viewcode-block" id="GoogleImageDownload.download"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.GoogleImageDownload.download">[docs]</a>    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Bulk download method.</span>
<span class="sd">           :return: A tuple made of the path of the image and the URL list of the images.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># for input coming from other python files</span>
        <span class="k">if</span> <span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">ARGS_LIST</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Initialization and Validation of user self.configuration</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]:</span>
            <span class="n">search_keyword</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;keywords_from_file&#39;</span><span class="p">]:</span>
            <span class="n">search_keyword</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">keywords_from_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;keywords_from_file&#39;</span><span class="p">])</span>

        <span class="c1"># both time and time range should not be allowed in the same query</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;time_range&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">GoogleImageDownloadException</span><span class="p">(</span>
                <span class="s1">&#39;Either time or time range should be used in a query. Both cannot be used at the same time.&#39;</span><span class="p">)</span>

        <span class="c1"># both time and time range should not be allowed in the same query</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;exact_size&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Either &quot;size&quot; or &quot;exact_size&quot; should be used in a query. Both cannot be used at the same time.&#39;</span><span class="p">)</span>

        <span class="c1"># both image directory and no image directory should not be allowed in the same query</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;image_directory&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;no_directory&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You can either specify image directory or specify no image directory, not both!&#39;</span><span class="p">)</span>

        <span class="c1"># Additional words added to keywords</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;suffix_keywords&#39;</span><span class="p">]:</span>
            <span class="n">suffix_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span> <span class="k">for</span> <span class="n">sk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;suffix_keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">suffix_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

        <span class="c1"># Additional words added to keywords</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;prefix_keywords&#39;</span><span class="p">]:</span>
            <span class="n">prefix_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="k">for</span> <span class="n">sk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;prefix_keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prefix_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

        <span class="c1"># Setting limit on number of images to be downloaded</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]:</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]:</span>
            <span class="n">current_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">search_keyword</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;similar_images&#39;</span><span class="p">]:</span>
            <span class="n">current_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">search_keyword</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)]</span>

        <span class="c1"># If single_image or url argument not present then keywords is mandatory argument</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;single_image&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;similar_images&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;keywords_from_file&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Uh oh! Keywords is a required argument. Please refer to the documentation on guide to writing queries&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

        <span class="c1"># If this argument is present, set the custom output directory</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;output_directory&#39;</span><span class="p">]:</span>
            <span class="n">main_directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;output_directory&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">main_directory</span> <span class="o">=</span> <span class="s2">&quot;downloads&quot;</span>

        <span class="c1"># Proxy settings</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;proxy&#39;</span><span class="p">]:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;http_proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;proxy&#39;</span><span class="p">]</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;https_proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;proxy&#39;</span><span class="p">]</span>
            <span class="c1"># Initialization Complete</span>

        <span class="n">paths</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">pky</span> <span class="ow">in</span> <span class="n">prefix_keywords</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sky</span> <span class="ow">in</span> <span class="n">suffix_keywords</span><span class="p">:</span>  <span class="c1"># 1.for every suffix keywords</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">search_keyword</span><span class="p">):</span>  <span class="c1"># 2.for every main keyword</span>
                    <span class="n">iteration</span> <span class="o">=</span> <span class="s2">&quot;Item no.: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; --&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot; Item name = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pky</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                        <span class="n">search_keyword</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sky</span><span class="p">))</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">iteration</span><span class="p">)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Evaluating...&quot;</span><span class="p">)</span>
                    <span class="n">search_term</span> <span class="o">=</span> <span class="n">pky</span> <span class="o">+</span> <span class="n">search_keyword</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">sky</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;image_directory&#39;</span><span class="p">]:</span>
                        <span class="n">dir_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;image_directory&#39;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;no_directory&#39;</span><span class="p">]:</span>
                        <span class="n">dir_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dir_name</span> <span class="o">=</span> <span class="n">search_term</span> <span class="o">+</span> <span class="p">(</span>
                            <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># sub-directory</span>

                    <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">create_directories</span><span class="p">(</span><span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;thumbnail&#39;</span><span class="p">])</span>  <span class="c1"># create directories in OS</span>

                    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_url_parameters</span><span class="p">()</span>  <span class="c1"># building URL with params</span>

                    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_search_url</span><span class="p">(</span><span class="n">search_term</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">],</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;similar_images&#39;</span><span class="p">],</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;specific_site&#39;</span><span class="p">],</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;safe_search&#39;</span><span class="p">])</span>  <span class="c1"># building main search url</span>

                    <span class="k">if</span> <span class="n">limit</span> <span class="o">&lt;</span> <span class="mi">101</span><span class="p">:</span>
                        <span class="n">raw_html</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">download_page</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>  <span class="c1"># download page</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">raw_html</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">download_extended_page</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                                                                              <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;chrome_driver_path&#39;</span><span class="p">])</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;no_download&#39;</span><span class="p">]:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting to Print Image URLS&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting Download...&quot;</span><span class="p">)</span>
                    <span class="c1"># get all image items and download images</span>
                    <span class="n">items</span><span class="p">,</span> <span class="n">error_count</span><span class="p">,</span> <span class="n">abs_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_all_items</span><span class="p">(</span><span class="n">raw_html</span><span class="p">,</span> <span class="n">main_directory</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
                    <span class="n">paths</span><span class="p">[</span><span class="n">pky</span> <span class="o">+</span> <span class="n">search_keyword</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">sky</span><span class="p">]</span> <span class="o">=</span> <span class="n">abs_path</span>

                    <span class="c1"># dumps into a json file</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;extract_metadata&#39;</span><span class="p">]:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">):</span>
                                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
                        <span class="n">json_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;logs/&quot;</span> <span class="o">+</span> <span class="n">search_keyword</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
                        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">json_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                    <span class="c1"># Related images</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;related_images&#39;</span><span class="p">]:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting list of related keywords...this may take a few moments&quot;</span><span class="p">)</span>
                        <span class="n">tabs</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">get_all_tabs</span><span class="p">(</span><span class="n">raw_html</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tabs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="n">final_search_term</span> <span class="o">=</span> <span class="p">(</span><span class="n">search_term</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Now Downloading - </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">final_search_term</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">limit</span> <span class="o">&lt;</span> <span class="mi">101</span><span class="p">:</span>
                                <span class="n">new_raw_html</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">download_page</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># download page</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">new_raw_html</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">download_extended_page</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                                                          <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span>
                                                                                              <span class="s1">&#39;chrome_driver_path&#39;</span><span class="p">])</span>
                            <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">create_directories</span><span class="p">(</span><span class="n">main_directory</span><span class="p">,</span> <span class="n">final_search_term</span><span class="p">,</span>
                                                                   <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;thumbnail&#39;</span><span class="p">])</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_get_all_items</span><span class="p">(</span><span class="n">new_raw_html</span><span class="p">,</span> <span class="n">main_directory</span><span class="p">,</span> <span class="n">search_term</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>

                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Errors: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">error_count</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s1">&#39;print_paths&#39;</span><span class="p">]:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">paths</span><span class="p">,</span> <span class="n">url</span></div></div>


<span class="c1"># ------------- Main Program -------------#</span>
<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../index.html#google_images_download.google_images_download.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function executed when the script in run command line.:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">records</span> <span class="o">=</span> <span class="n">user_input</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">arguments</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">arguments</span><span class="p">[</span><span class="s1">&#39;single_image&#39;</span><span class="p">]:</span>  <span class="c1"># Download Single Image using a URL</span>
            <span class="n">GoogleImageDownload</span><span class="o">.</span><span class="n">single_image</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="s1">&#39;single_image&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># or download multiple images based on keywords/keyphrase search</span>
            <span class="n">time_0</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>  <span class="c1"># start the timer</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">GoogleImageDownload</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Everything downloaded!&quot;</span><span class="p">)</span>
            <span class="n">time_1</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>  <span class="c1"># stop the timer</span>
            <span class="c1">#  Calculating the total time required to crawl, find and download all the links of 60,000 images</span>
            <span class="n">total_time</span> <span class="o">=</span> <span class="n">time_1</span> <span class="o">-</span> <span class="n">time_0</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Total time taken: </span><span class="si">%11.2f</span><span class="s2"> seconds.&quot;</span><span class="o">%</span> <span class="n">total_time</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Entry point of the script when executed in command line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Christophe Brun.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>